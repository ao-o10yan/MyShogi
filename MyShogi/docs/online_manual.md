
# 操作説明(オンラインマニュアル)


- 『将棋神やねうら王』(2018年8月発売)に関するマイナビ公式のアップデート情報については、[マイナビ 将棋神やねうら王](https://book.mynavi.jp/ec/products/detail/id=92007)をご確認ください。
  - Update1(不具合修正・細かいな機能追加たくさん)は、2018年9月3日を予定しています。
    - Update1(非公式)は、すでに公開してあります。→ [『将棋神やねうら王』Update1(非公式)を公開しました。](http://yaneuraou.yaneu.com/2018/08/31/%E3%80%8E%E5%B0%86%E6%A3%8B%E7%A5%9E%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%80%8Fupdate1%E9%9D%9E%E5%85%AC%E5%BC%8F%E3%82%92%E5%85%AC%E9%96%8B%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82/)
  - Update2(大型アップデートその2)は、2018年9月中旬を予定しています。棋譜解析・棋譜コメント機能・形勢グラフの追加などを予定しています。
- サウンドが再生されない、CPU負荷が高すぎる/低すぎるなどについては、[よくある質問集](faq.md)をご覧ください。
- デバッグ機能の使い方などは、[開発者向け機能](dev_manual.md)をご覧ください。
- 今後のアップデートの予定など、作業進捗については、[WIP](WIP.md)をご覧ください。
- バグ、要望等は、[バグ・要望等　総合受付](https://github.com/yaneurao/MyShogi/issues/33)にどうぞ。
- ここではそれら以外の操作説明について書いてあります。


## 通常対局の仕方


- メニューの「対局」→「通常対局」を選ぶと対局設定ダイアログが出てきます。
- そのあと、先手と後手について、「人間」であるか「コンピューター」であるかを選びます。「コンピューター」を選んだときは思考エンジンの選択画面になります。
- 棋力は思考エンジンに備わっているプリセットのなかから選べます。(「10級」～「九段」、「将棋神」、「カスタム」など)
- 「対局開始」ボタンをクリックすると対局開始になります。

- Q) 「九段」と「将棋神」とではどちらが強いですか？
  - A) 「九段」は九段ぐらいの強さになるように棋力を(弱く)調整したものです。
  「将棋神」のほうは、(弱く)調整されるということはなく、対局時間設定とお使いのPCの性能に依存した強さになります。

- Q) エンジンの詳細設定の各オプションを元の値に戻したい。
  - A) (Update1以降)マウスをオプション項目のところにホバーさせるとtooltip(説明)が出ます。その一番下に元の値が「デフォルト値 = XXX」という形で表示されています。
  - (Update1以降)すべてのエンジンオプションの初期化を行うには、次の機能でできます。
    - メニュー「ファイル」→「設定の初期化」→「各エンジン設定の初期化」

- Q) 秒読み3秒のときに3/3になる前に時間切れで負けになる。
  - A) 秒読み3秒のときは2.99秒まではセーフで、2.99秒は表示上は2/3です。
    この状態までが時間切れではないという解釈で、3/3になった時点(3.00秒)で時間切れになります。
    ※　製品版(V1.00)では、3.99秒までをセーフとしていたのですが、その後のV1.05以降で2.99秒までをセーフであると修正しました。


## 検討モードの使い方


- Q) 検討モードはどうすれば開始できますか？
  - A) 対局中ではないときに、メニュー下のTooltip(ボタンの並び)にある「検」ボタン(検討ボタン)をクリックしてください。
  - 一度目は検討で用いる思考エンジンの選択画面になります。

- Q) 検討モードで用いる思考エンジンの選択画面を再度出すにはどうすれば良いですか？
  - A) メニューの「対局」→「検討エンジン設定」から出すことが出来ます。

- Q) 検討モードのときに盤面の駒を動かすことは出来ますか？
  - A) 対局時と同様に駒をマウスの操作で動かすことが出来ます。
    - このとき、合法手しか指せません。将棋のルールを無視して自由に駒を動かすには、盤面編集モードを使う必要があります。
    - また、棋譜ウィンドウ上の特定の指し手をマウスでクリックするか、カーソルキーで移動するかして、棋譜のその局面に移動すると自動的に
    思考エンジンがその局面に対する検討を開始します。

- Q) 検討モードを終了するには？
  - A) 「検」ボタンがあったところが「終」になっているはずです。このボタンを押すと終了します。
  
- Q) 検討モードのミニ盤面はどうやったら動きますか？
  - A) 読み筋のところをクリック(or カーソルキーなどで選択)すると、検討ウィンドウのミニ盤面にその局面と変化が反映されます。そのあと、ミニ盤面の下にある「◀」「▶」などで局面を進めたり戻したりできます。

- Q) 評価値とは何ですか？
  - A) 思考エンジンが現在の局面の形勢をどのように評価しているかを数値化したものです。
    良いとプラス、悪いとマイナスの値になります。
    歩1枚の点数が100点を意味するように正規化されて表示されています。
    - 将棋では、手駒という概念があるので、歩1枚の駒得は、自分の手駒の歩(+100) + 相手の歩の欠損(+100) = +200の評価値として表現されます。
    - 詰みを見つけた時の値は大きな値になります。

- Q) 後手の評価値は手番側(後手)から見た評価値ですか？
  - A) デフォルトではそうなっています。
  - これは、メニューの「表示」→「後手番のCPUの評価値を反転表示させるか」のところから反転させることが出来ます。

- Q) 手番側から見た評価値だと、形勢グラフに先手と後手と両方の評価値をプロットしたときに後手は符号を逆にしないとおかしくなりませんか？
  - A) はい、おかしくなります。このため、形勢グラフを見ることが前提にあるなら、後手番の評価値は反転表示されていないと紛らわしいように思います。

- Q) "++/--"の列はどういう意味ですか？
  - A) その評価値がupperbound(≒上限値)、lowerbound(≒下限値)であることを示します。
      例えば、"++"と出ていて、評価値が1000と出ていれば、真の値(本当の評価値)は、それよりは低そうだと思考エンジンは見積もっているということを示しています。

- Q) 読み筋に表示されることのある「優等局面」「劣等局面」とは何ですか？
  - A) 将棋で4手セットで、歩を無条件に相手に渡すことがあります。「23歩成、同玉、24歩、22玉」を繰り返すと先手のほうは手駒の歩が1つずつ相手の手駒に移動します。
    これは元の局面より絶対的に優れていると考えられるので、思考エンジンはここで読みを打ち切ります。
    このとき「(先手から見て)劣等局面に突入」したと言います。後手から見ると「優等局面に突入した」と言います。

- Q)「候補手５手」になっているのに平手の開始局面で5手以上表示されます。
  - A) 定跡にヒットした場合は、その内容をすべて表示します。これは仕様です。

- Q) 定跡にヒットしたときに読み筋の指し手のところに「(98.3%)」のような数字が書いてありますが、これは何ですか？
  - A) その定跡の出現率です。実戦譜のようなものから生成した定跡ファイルだと、出現頻度が記載してあるので、それを表示しています。

- Q) 継ぎ盤(ミニ盤面)を大きくしたいのですが。
  - A) 検討ウィンドウのウインドウ自体の高さをマウスで(ウィンドウの隅をドラッグして)変更するとそれに追随して自動的に継ぎ盤も大きくなります。


## 詰将棋モードの使い方

- Q) 詰検討はどうすれば開始できますか？
  - A) 対局中ではないときに、メニューのTooltipにある「詰」ボタン(詰検討ボタン)をクリックしてください。

- Q) 詰検討モードで用いる思考エンジンの選択画面を再度出すにはどうすれば良いですか？
  - A) メニューの「対局」→「詰検討エンジン設定」から出すことが出来ます。

- Q) 詰検討モードを終了するには？
  - A) 「詰」ボタンがあったところが「終」になっているはずです。このボタンを押すと終了します。

- Q) 詰検討モードのときに盤面の駒を動かすことは出来ますか？
  - A) 検討モード同様、駒のマウス操作、棋譜ウィンドウの操作を行うことが出来ます。

- Q) メモリがたくさんある環境で詰検討を開始すると例外が出てソフトが終了します。
  - A) 申し訳ありません。エンジン側がメモリを開始時に二重に確保していました。このためメモリ不足で終了することがありました。Update1で修正されます。


## 盤面編集


- Q) 盤面編集はどうすれば出来ますか？
  - A) 対局中ではないときに、メニューの「盤面編集」→「盤面編集の開始」のところから行えます。

- Q) 盤面編集で成り駒を作るには？
  - A) 駒の上でマウスの右クリックをすると先手の駒→先手の成り駒→後手の駒→後手の成り駒という順番で変化します。

- Q) 盤面編集で、相手の駒を取ると取れずに自分の駒と入れ替わってしまします。
  - A) 将棋所やShogiGUIでは、手駒に移動しますが、本ソフトでは「マウスで駒の移動元と移動先に駒がある場合はその2駒を入れ替える」ようになっています。
  - 例えば、将棋所方式だと、駒を移動させて玉の上に持ってくることが出来ません。(玉が手駒に移動させられないため)
  - なので、本ソフトの仕様のほうが、慣れれば便利かと思っていますが、この仕様が不評でしたら、将棋所やShogiGUIのような仕様に将来的に変更するかも知れません。


## 表示設定について


- Q) 表示設定をすべて初期状態に戻すことはできますか？
  - A) (Update1以降)次の方法で出来ます。
    - メニュー「ファイル」→「設定の初期化」→「各表示設定などの初期化」

## 棋譜の自動保存について


- Q) 対局結果はどこで確認できますか？
  - A) メニューの「ウインドウ」→「対局結果一覧」から確認できます。

- Q) 棋譜の自動保存をしないようにするにはどうすれば良いですか？
  - A) メニューの「ウインドウ」→「対局結果の保存設定」から設定できます。


## 連続対局について


- Q) 連続対局のときに画面上に表示される「6-4-0 (60.0% R70.4)」のような数字はどういう意味ですか？
  - A) 「6-4-0」は先手勝ち局数 = 6、後手勝ちの局数 = 4、引き分けの局数 = 0という意味です。
    「60.0%」は先手から見た勝率。「R70.4」は、先手が後手よりどれだけR(レーティング)が高いかです。

- Q) レーティングとは何ですか？
  - A) チェスでよく使われている強さの指標です。本ソフトではElo ratingを採用しています。

- Q) 連続対局の結果はどこで確認できますか？
  - A) メニューの「ウインドウ」→「対局結果一覧」から確認できます。

- Q) 対局結果一覧に出てくる情報はどこに書き出されていますか？
  - A) メニューの「ウインドウ」→「対局結果の保存設定」で設定したフォルダの"game_result.csv"というファイルに書き出されています。
  - このファイルを最新版のExcel(Excel 2016)で開けることは確認しています。
  - 文字のエンコードがutf-8のCSVファイルなので古いExcelで文字化けするときは、

- Q) 「十二段」で特定の局面から連続対局をさせると何度やっても同じ棋譜(同じ進行)になります。
  - A) 棋力が高くなってくると指し手のばらつきが減るので(神の指し手に近づいていくから？)、あまり変化のない局面からだと同じエンジンである以上、同じ進行になりやすいです。
  - 複数エンジンでの対局が自動化出来る、蠱毒という機能(≒リーグ戦機能)を将来的につける予定です。そちらならば、棋譜がある程度バラけると思います。
  

## 棋譜の入出力


- 棋譜をファイルから読み込むには、メニューの「ファイル」→「棋譜を開く」を選びます。
- 棋譜をファイルに書き出すには、メニューの「ファイル」→「棋譜に名前をつけて保存」 を選びます。
 
- 対応している棋譜/局面のフォーマット KIF,KI2,CSA,SFEN,PSN,PSN2形式
  - 棋譜を読み込む時は、どのフォーマットであるか自動判定します。
  - 書き出し時は、上記のどの形式で書き出すのかを選択する必要があります。

- Q) 局面図を将棋の書籍にある局面図のような白黒画像で出力したいのですが。
  - A) 画像で出力する機能はありませんが、SVG形式でファイルに出力する機能はあります。
    メニュー「ファイル」→「局面の保存」でSVG形式を選択すれば、SVG形式でファイルに書き出すことが出来ます。
    このファイルは、Chrome , IE , Microsoft Edgeなどのブラウザで開くことが出来ます。ブラウザによって微妙に見え方が異なります。Chromeをお勧めします。
  
- Q) KIF形式で書き出したファイルが柿木将棋IXで読み込めません。
  - A) 本ソフトは、棋譜の文字のエンコードをutf-8で書き出すためです。(柿木将棋がUnicodeのファイルに対応していないためです。)
    - Kifu for Windows V7 , 将棋所 , ShogiGUIでは問題なく読み込めるようです。
    - 参考記事 : [『将棋神やねうら王』で書き出したKIFファイルが『柿木将棋』で読み込めない件](http://yaneuraou.yaneu.com/2018/08/31/%E3%80%8E%E5%B0%86%E6%A3%8B%E7%A5%9E%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%80%8F%E3%81%A7%E6%9B%B8%E3%81%8D%E5%87%BA%E3%81%97%E3%81%9Fkif%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C/)
    - 解決策1) 本ソフトで保存したファイルをテキストエディタで開いてsjisで保存しなおすと読み込めるようになります。
    - 解決策2) 本ソフトのメニューの「ファイル」→「クリップボードに棋譜/局面をコピー」(Update1以降、Ctrl+Vで可)でKIF形式を選び、柿木将棋にCtrl+Vで貼り付ければ読み込めます。
    - 解決策3) 『Kifu for Windows V7』で一度読み込み、KIF形式で保存しなおす。


- Q) 文字のエンコード、sjis(Shift_JIS)で書き出す機能はありませんか？
  - A) 対局者名にsjisで表現出来ない文字を使うことがありますし、sjis形式のkifファイルは将来的になくなっていくと考えられるのであえてつけていないです。


## コマンドラインからのコマンドについて

- Q)『棋譜の管理』という棋譜データベースからこのソフトを起動したいのですが、起動時にコマンドラインから棋譜ファイルを指定することは出来ますか？
  - A) MyShogi.exe -f [ファイル名] のようにすると、その棋譜ファイルを起動時に開くことが出来ます。(Update1.3以降)


## 便利な機能(tips)


- 棋譜ファイルをメインウインドウにドラッグ＆ドロップするとその棋譜が読み込めます。
- メインウィンドウがアクティブな時にCtrl+Cで現在の棋譜をKIF形式でクリップボードにコピーすることが出来ます。
- メインウインドウがアクティブな時にCtrl+Vで棋譜テキストをクリップボードからペーストする(読み込むこと)が出来ます。
