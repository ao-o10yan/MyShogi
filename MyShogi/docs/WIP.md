
# 『将棋神やねうら王』(2018年8月31日発売) アップデートなどの作業進捗 (Work In Progress)


- このファイルは、既知の問題や作業中の内容を明示することにより、それらに対するバグ報告を未然に防ぐためのものです。

- マイナビ公式のアップデート情報については、[マイナビ 将棋神やねうら王](https://book.mynavi.jp/ec/products/detail/id=92007)をご確認ください。
  - マイナビ公式のサイトにて、Update1.3(V1.13)が公開されました。[2018/09/06]
  - Update2(大型アップデートその2)は、2018年9月中旬を予定しています。棋譜解析・棋譜コメント機能・形勢グラフの追加などを予定しています。
- 全体的な操作説明については[オンラインマニュアル](online_manual.md)をご覧ください。
- サウンドが再生されない、CPU負荷が高すぎる/低すぎるなどについては、[よくある質問](faq.md)をご覧ください。
- デバッグ機能の使い方などは、[開発者向け機能](dev_manual.md)をご覧ください。
- バグ、要望等は、
  - [『将棋神やねうら王』Update2までの遊戯施設 / やねうら王ブログ](http://yaneuraou.yaneu.com/2018/09/06/%E3%80%8E%E5%B0%86%E6%A3%8B%E7%A5%9E%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%80%8Fupdate2%E3%81%BE%E3%81%A7%E3%81%AE%E9%81%8A%E6%88%AF%E6%96%BD%E8%A8%AD/)
  にどうぞ。


# Update2(2018年9月中旬ごろリリース予定)に向けて作業中です(ここに書かれているすべての機能追加をお約束するものではありません)


対局
  - 対局中断→再開が欲しい。
  - 棋譜の途中から対局をするとき、そこより手数を戻そうとすると持ち時間がゼロになるので時間切れ負けになる件
  - 秒読み60秒のとき「40秒・・・50秒・1・2・3・・」みたいな感じで秒読みを入れる。

- 棋譜ウインドウ
  - 棋譜分岐、分岐の指し手、一覧が表示されて欲しい気が。
    - もう少しいいインターフェースを考え中。
  - 棋譜コメントの表示、編集等
  - 思考エンジンの読み筋を棋譜コメントに記録する
  - 本譜のみ書き出し
  - 棋譜のマージ

- 検討ウインドウ
  - 棋譜ウインドウと同じくフロート機能追加する

- 棋譜解析

- 形勢グラフ(作業中)
	- このウィンドウ邪魔なので、検討ウィンドウに埋める予定
  - ToolStripの◀▶で局面を移動させた時にその局面での形勢表示にならない。
    - 検討ウィンドウのほうと合わせ、通知のハンドラちゃんと書く。
  - 着手や終局の直後に入れ違いで前の局面の思考が送られてきた時に、次の局面の評価値として記録してしまう。
    - あとで修正する。
  - このソフトで保存した棋譜を再度読み込んだ時にその評価値が形勢グラフに反映されない。
  - 駒落ちの時、詰まされると落ちる。(tkponさん)
    - 形勢グラフの範囲外にプロットしている模様。

- 描画の高速化
	- 画面描画の時の更新矩形を最適化する
		- 残り時間の描画など

- tanuki-詰将棋エンジン
  - 他の不詰の局面を調べた直後に(エンジンをそのまま終了させずに)、詰むはずの局面を解かせたときに即座に不詰が返ってくる問題。
  - 「終」ボタンでいったんエンジンを終了させて再度解かせると正常に解ける模様。調査中。


# 対応を検討中


- もっと使いやすい表示設定ダイアログを用意する

- USIプロトコル対応エンジンを任意に追加する機能

- ponder(「相手の手番で先読み」)
  - この実装、わりとややこしくて、激指ユーザーとかがターゲットなので必須機能とも言えないので後回し。


# 改修履歴


- "1.1.5"→"1.1.6" [2018/09/08]-[2018/09/XX]
  - 棋譜を開くときに、棋譜ウインドウがTopMostなのでファイルダイアログより前面に出てくるの改善。
    - Owner設定するようにして、TopMostやめた。


- "1.1.4"→"1.1.5" [2018/09/07]-[2018/09/07]
  - メインウインドウを最小化したときに棋譜ウインドウをウインドウ化しているときには非表示にするように。(kumaさん)
  - 実行ファイルのアプリケーションアイコンを設定。(kumaさん)
  - 棋譜ウインドウ、ウインドウモード時に、文字サイズを変更するボタンを追加。(右下の「+」と「-」)
  - 棋譜ウインドウに「消一手」ボタン追加。
    - 棋譜の末尾を1手消す操作
    - 棋譜ウインドウのボタンにtooltip追加。
  - V1.1.4で対局中に閉じるときなど、警告ダイアログが2回出るようになっていたの修正。
  - tanuki-詰将棋エンジン , 置換表エントリの世代を削除し、置換表エントリのハッシュの最下位ビットに探索開始局面の手番を入れるようにした #89 (tanuki-さん。やねうら王へのプルリク)
    - この修正により、一度解いた局面を解かせるときには一瞬で応答が返ってくるようになった。
  - tanuki-詰将棋エンジン バグ修正。
    詰将棋ルーチンで受け側の局面から探索させたあとに攻め側の局面から探索させると不詰と出力されるバグを修正した #88 (tanuki-さんのやねうら王へのプルリク)


- "1.1.3"→"1.1.4" [2018/09/04]-[2018/09/06]
  - CSA: 一部ツールの出力する棋譜による不具合に対応 #52 (Mizarさんのプルリク)
    - 将棋ウォーズ棋譜管理ツールというフリーソフトで保存したcsa形式のファイルが読み込めない。(てらっちさん)
  - メニューの「ウインドウ」→「棋譜ウインドウ」→「表示位置」でフロート機能などを使えるようになった。
    - フロート状態を次回起動時に復元するようにした。
    - Dock機能追加。メインウインドウに対して上下左右、好きなところにDockさせられるようにする。
  - tanuki-詰将棋エンジン、ハッシュエントリをつぶすとき、探索ノード数を考慮するようにした #87 tanuki-さんのやねうら王へのプルリク
  - 駒をクリックするときにマウスカーソルを微小動かすと駒のドラッグ処理になり、駒を掴んだ直後に駒を離してしまう。(地球市民さん)
    - 確かにあまり嬉しくない挙動なので修正しました。
  - 連続対局のときの勝数、win-lose-draw ではなくwin-draw-loseに変更する。(odagaki0621さん)


- β10.1を『将棋神やねうら王』(2018年8月31日発売)のマスターアップ版としました。開発・テストにご協力いただいた皆様、ありがとうございました。[2018/08/05]


## 過去の改修履歴

- ここ以前の改修履歴については、[過去の改修履歴](過去の改修履歴.md)のほうに移動させました。
